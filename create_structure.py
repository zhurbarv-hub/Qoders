# -*- coding: utf-8 -*-
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–ø–æ–∫ –ø—Ä–æ–µ–∫—Ç–∞ KKT
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ —Ñ–∞–π–ª—ã
"""

import os
import sys

def create_project_structure():
    """–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞"""
    
    # –ü–æ–ª—É—á–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å–∫—Ä–∏–ø—Ç
    base_dir = os.path.dirname(os.path.abspath(__file__))
    
    print("=" * 60)
    print("–°–û–ó–î–ê–ù–ò–ï –°–¢–†–£–ö–¢–£–†–´ –ü–†–û–ï–ö–¢–ê KKT")
    print("=" * 60)
    print(f"\n–ë–∞–∑–æ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: {base_dir}\n")
    
    # –°–ø–∏—Å–æ–∫ –ø–∞–ø–æ–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è
    directories = [
        "backend",
        "backend/api",
        "backend/utils",
        "bot",
        "scheduler",
        "frontend",
        "frontend/static",
        "frontend/static/css",
        "frontend/static/js",
        "frontend/templates",
        "database",
        "logs",
        "backups"
    ]
    
    # –§–∞–π–ª—ã __init__.py –¥–ª—è Python –ø–∞–∫–µ—Ç–æ–≤
    init_files = [
        "backend/__init__.py",
        "backend/api/__init__.py",
        "backend/utils/__init__.py",
        "bot/__init__.py",
        "scheduler/__init__.py"
    ]
    
    # .gitkeep –¥–ª—è –ø—É—Å—Ç—ã—Ö –ø–∞–ø–æ–∫ (—á—Ç–æ–±—ã Git –∏—Ö –æ—Ç—Å–ª–µ–∂–∏–≤–∞–ª)
    gitkeep_folders = [
        "logs",
        "backups"
    ]
    
    created_dirs = 0
    created_files = 0
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–æ–∫
    print("üìÅ –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–æ–∫:")
    print("-" * 60)
    for directory in directories:
        dir_path = os.path.join(base_dir, directory)
        try:
            os.makedirs(dir_path, exist_ok=True)
            print(f"  ‚úì {directory}")
            created_dirs += 1
        except Exception as e:
            print(f"  ‚úó {directory} - –û–®–ò–ë–ö–ê: {e}")
    
    # –°–æ–∑–¥–∞–Ω–∏–µ __init__.py —Ñ–∞–π–ª–æ–≤
    print("\nüìÑ –°–æ–∑–¥–∞–Ω–∏–µ __init__.py —Ñ–∞–π–ª–æ–≤:")
    print("-" * 60)
    for init_file in init_files:
        file_path = os.path.join(base_dir, init_file)
        try:
            with open(file_path, 'w', encoding='utf-8') as f:
                f.write("# Package initialization\n")
                f.write("# Auto-generated by create_structure.py\n")
            print(f"  ‚úì {init_file}")
            created_files += 1
        except Exception as e:
            print(f"  ‚úó {init_file} - –û–®–ò–ë–ö–ê: {e}")
    
    # –°–æ–∑–¥–∞–Ω–∏–µ .gitkeep —Ñ–∞–π–ª–æ–≤
    print("\nüîñ –°–æ–∑–¥–∞–Ω–∏–µ .gitkeep —Ñ–∞–π–ª–æ–≤:")
    print("-" * 60)
    for folder in gitkeep_folders:
        gitkeep_path = os.path.join(base_dir, folder, ".gitkeep")
        try:
            with open(gitkeep_path, 'w') as f:
                f.write("")  # –ü—É—Å—Ç–æ–π —Ñ–∞–π–ª
            print(f"  ‚úì {folder}/.gitkeep")
            created_files += 1
        except Exception as e:
            print(f"  ‚úó {folder}/.gitkeep - –û–®–ò–ë–ö–ê: {e}")
    
    # –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    print("\n" + "=" * 60)
    print("–†–ï–ó–£–õ–¨–¢–ê–¢:")
    print("=" * 60)
    print(f"‚úÖ –°–æ–∑–¥–∞–Ω–æ –ø–∞–ø–æ–∫: {created_dirs}")
    print(f"‚úÖ –°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: {created_files}")
    print("\nüéâ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!")
    print("=" * 60)
    
    # –í—ã–≤–æ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–µ—Ä–µ–≤–∞
    print("\nüìÇ –°–æ–∑–¥–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:")
    print("-" * 60)
    display_tree(base_dir, directories)
    
    return True

def display_tree(base_dir, directories):
    """–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–ø–æ–∫ –≤ –≤–∏–¥–µ –¥–µ—Ä–µ–≤–∞"""
    tree_lines = []
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ —É—Ä–æ–≤–Ω—è–º
    dir_dict = {}
    for d in sorted(directories):
        parts = d.split('/')
        current = dir_dict
        for part in parts:
            if part not in current:
                current[part] = {}
            current = current[part]
    
    def print_tree(d, prefix="", is_last=True):
        items = list(d.items())
        for i, (name, sub) in enumerate(items):
            is_last_item = (i == len(items) - 1)
            connector = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            print(prefix + connector + name + "/")
            
            if sub:
                extension = "    " if is_last_item else "‚îÇ   "
                print_tree(sub, prefix + extension, is_last_item)
    
    print("KKT/")
    print_tree(dir_dict)

if __name__ == '__main__':
    try:
        create_project_structure()
        input("\n\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")
    except Exception as e:
        print(f"\n‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: {e}")
        input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")
        sys.exit(1)