# –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ Telegram –±–æ—Ç–∞: –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –¥–µ–¥–ª–∞–π–Ω–∞—Ö

## –û–±–∑–æ—Ä

–î–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫—É Telegram –±–æ—Ç–∞ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ –ö–ö–¢, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É—è –µ–≥–æ –∏–∑ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å —Ä–æ–ª–µ–≤—ã–º –¥–æ—Å—Ç—É–ø–æ–º –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤, –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –∏ –∫–ª–∏–µ–Ω—Ç–æ–≤.

## –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –ë–æ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –¥–µ–¥–ª–∞–π–Ω–æ–≤ –≤ Telegram
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏

### –¶–µ–ª–µ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –ë–æ—Ç —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–µ
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ –≤–µ–±-–∫–æ–Ω—Å–æ–ª—å
- –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ Telegram
- –†–æ–ª–µ–≤–æ–π –¥–æ—Å—Ç—É–ø –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤, –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –∏ –∫–ª–∏–µ–Ω—Ç–æ–≤
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –¥–µ–¥–ª–∞–π–Ω—ã, –ø–æ–ª—É—á–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Ä—É—á–Ω—É—é

## –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**: –û–ø–µ—Ä–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –≤–µ–±-–∫–æ–Ω—Å–æ–ª–∏; –±–æ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è
2. **–°–∞–º–æ–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤**: –ö–ª–∏–µ–Ω—Ç—ã –º–æ–≥—É—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–≤–æ–∏ –¥–µ–¥–ª–∞–π–Ω—ã –∞–≤—Ç–æ–Ω–æ–º–Ω–æ
3. **–†–æ–ª–µ–≤–æ–π –¥–æ—Å—Ç—É–ø**: –†–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤, –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –∏ –∫–ª–∏–µ–Ω—Ç–æ–≤
4. **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**: –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ–º–∏ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–º–∏ —Å—Ç–æ—Ä–æ–Ω–∞–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –¥–µ–¥–ª–∞–π–Ω–∞—Ö
5. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–æ–¥–µ–ª–µ–π –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –û–±–∑–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å | –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è |
|-----------|----------------|--------------------|
| –í–µ–±-–∫–æ–Ω—Å–æ–ª—å | –í—Å–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –¥–µ–¥–ª–∞–π–Ω–æ–≤, –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π | –ò–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è |
| Telegram –±–æ—Ç | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ | –£–¥–∞–ª–∏—Ç—å CRUD –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, –¥–æ–±–∞–≤–∏—Ç—å –ø–æ—Ç–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –¥–µ–¥–ª–∞–π–Ω–æ–≤ | –£–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é –º–æ–¥–µ–ª—å User —Å —Ä–æ–ª—è–º–∏ |
| –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–µ–¥–ª–∞–π–Ω–æ–≤ | –£–ª—É—á—à–∏—Ç—å –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π |
| –°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π | –î–æ—Å—Ç–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π | –†–∞—Å—à–∏—Ä–∏—Ç—å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π |

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```mermaid
flowchart TB
    WebConsole[–í–µ–±-–∫–æ–Ω—Å–æ–ª—å] -->|–£–ø—Ä–∞–≤–ª—è–µ—Ç| DB[(–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)]
    Scheduler[–°–µ—Ä–≤–∏—Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞] -->|–ß–∏—Ç–∞–µ—Ç| DB
    Scheduler -->|–ó–∞–ø—É—Å–∫–∞–µ—Ç| Notifier[–°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π]
    Notifier -->|–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç| AdminBot[Telegram –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞/–º–µ–Ω–µ–¥–∂–µ—Ä–∞]
    Notifier -->|–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç| ClientBot[Telegram –∫–ª–∏–µ–Ω—Ç–∞]
    
    TGBot[Telegram –±–æ—Ç] -->|–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è| AuthService[–°–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏]
    AuthService -->|–ü—Ä–æ–≤–µ—Ä—è–µ—Ç| DB
    TGBot -->|–ß–∏—Ç–∞–µ—Ç| DB
    TGBot -->|–†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫| Notifier
    
    Admin[–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä] -->|–ö–æ–º–∞–Ω–¥—ã| TGBot
    Client[–ö–ª–∏–µ–Ω—Ç] -->|–ö–æ–º–∞–Ω–¥—ã| TGBot
    Admin -->|–£–ø—Ä–∞–≤–ª—è–µ—Ç| WebConsole
```

## –ú–æ–¥–µ–ª—å —Ä–æ–ª–µ–π

### –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

| –†–æ–ª—å | –î–æ—Å—Ç—É–ø –≤ Telegram | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ |
|------|------------------|-------------|
| **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä** | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø | –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –¥–µ–¥–ª–∞–π–Ω–æ–≤, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º, –¥–æ—Å—Ç—É–ø –∫ –∫–∞—Ä—Ç–æ—á–∫–∞–º –∫–ª–∏–µ–Ω—Ç–æ–≤, —Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã |
| **–ú–µ–Ω–µ–¥–∂–µ—Ä** | –î–æ—Å—Ç—É–ø –Ω–∞ —á—Ç–µ–Ω–∏–µ | –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –¥–µ–¥–ª–∞–π–Ω–æ–≤, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º, –¥–æ—Å—Ç—É–ø –∫ –∫–∞—Ä—Ç–æ—á–∫–∞–º –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| **–ö–ª–∏–µ–Ω—Ç** | –õ–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø | –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏—Ö –¥–µ–¥–ª–∞–π–Ω–æ–≤, –ø–æ–ª—É—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —Å–≤–æ–∏—Ö —É—Å–ª—É–≥–∞—Ö |

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

#### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –∏ –º–µ–Ω–µ–¥–∂–µ—Ä—ã
- –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é `TELEGRAM_ADMIN_IDS`
- –†–∞—Å—à–∏—Ä—è–µ–º –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è `TELEGRAM_MANAGER_IDS` –¥–ª—è —Ä–æ–ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
- –ü—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)

#### –ö–ª–∏–µ–Ω—Ç—ã
- –î–≤—É—Ö—ç—Ç–∞–ø–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
  1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–≤–µ–±-–∫–æ–Ω—Å–æ–ª—å)
  2. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Telegram –±–æ—Ç–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–¥–∞

## –ü—Ä–æ—Ü–µ—Å—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

**–¢—Ä–∏–≥–≥–µ—Ä**: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞—ë—Ç –∏–ª–∏ –ø—Ä–∏–≥–ª–∞—à–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ –≤–µ–±-–∫–æ–Ω—Å–æ–ª—å

**–ü—Ä–æ—Ü–µ—Å—Å**:
1. –í–µ–±-–∫–æ–Ω—Å–æ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
2. –ö–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–æ–ª–µ `users.registration_code`
3. –ö–æ–¥ –∏—Å—Ç–µ–∫–∞–µ—Ç —á–µ—Ä–µ–∑ 72 —á–∞—Å–∞ (`users.code_expires_at`)
4. –ö–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É –ø–æ email –∏–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –¥–ª—è —Ä—É—á–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**:
- `users.registration_code` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –±—É–∫–≤–µ–Ω–Ω–æ-—Ü–∏—Ñ—Ä–æ–≤–æ–π –∫–æ–¥
- `users.code_expires_at` - –≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è
- `users.telegram_id` - –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ NULL, –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –ü–æ—Ç–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Telegram

```mermaid
sequenceDiagram
    participant Client as –ö–ª–∏–µ–Ω—Ç
    participant TGBot as Telegram –±–æ—Ç
    participant Auth as –°–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    participant DB as –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
    
    Client->>TGBot: /start
    TGBot->>Auth: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å telegram_id –≤ –ë–î
    Auth->>DB: –ó–∞–ø—Ä–æ—Å User –ø–æ telegram_id
    DB-->>Auth: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω
    Auth-->>TGBot: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
    TGBot->>Client: –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
    
    Client->>TGBot: [6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥]
    TGBot->>Auth: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥
    Auth->>DB: –ù–∞–π—Ç–∏ User –ø–æ registration_code
    DB-->>Auth: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω
    Auth->>Auth: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∫–æ–¥–∞
    Auth->>DB: –û–±–Ω–æ–≤–∏—Ç—å telegram_id, telegram_username
    Auth->>DB: –û—á–∏—Å—Ç–∏—Ç—å registration_code
    DB-->>Auth: –£—Å–ø–µ—Ö
    Auth-->>TGBot: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞
    TGBot->>Client: –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –í—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã
    TGBot->>Client: –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```

### –°–æ—Å—Ç–æ—è–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

| –°–æ—Å—Ç–æ—è–Ω–∏–µ | –£—Å–ª–æ–≤–∏–µ | –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã |
|-----------|---------|-------------------|
| **–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω** | `telegram_id` —Ä–∞–≤–µ–Ω NULL | `/start` (–∑–∞–ø—É—Å–∫–∞–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é) |
| **–û–∂–∏–¥–∞–Ω–∏–µ** | –ö–æ–¥ –≤–≤–µ–¥—ë–Ω, –æ–∂–∏–¥–∞–µ—Ç—Å—è –≤–∞–ª–∏–¥–∞—Ü–∏—è | –ù–µ—Ç (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å) |
| **–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω** | `telegram_id` –∑–∞–ø–æ–ª–Ω–µ–Ω | `/list`, `/today`, `/week`, `/next` |
| **–ö–æ–¥ –∏—Å—Ç—ë–∫** | –ö–æ–¥ —Å—Ç–∞—Ä—à–µ 72 —á–∞—Å–æ–≤ | `/start` (–∑–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–æ–≤—ã–π –∫–æ–¥ —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞) |

## –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

#### –ü–æ —Ç–∏–ø—É –¥–µ–¥–ª–∞–π–Ω–∞

| –¢–∏–ø –ø–æ–ª—É—á–∞—Ç–µ–ª—è | –£—Å–ª–æ–≤–∏–µ | –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è |
|----------------|-----------|--------------------|
| **–ö–ª–∏–µ–Ω—Ç** | –í–ª–∞–¥–µ–µ—Ç –¥–µ–¥–ª–∞–π–Ω–æ–º, `notifications_enabled = true` | –£—Å–ª—É–≥–∞ –∏—Å—Ç–µ–∫–∞–µ—Ç, —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏–µ |
| **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã** | –í—Å–µ –¥–µ–¥–ª–∞–π–Ω—ã | –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞ + –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è |
| **–ú–µ–Ω–µ–¥–∂–µ—Ä—ã** | –î–µ–¥–ª–∞–π–Ω—ã –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (–±—É–¥—É—â–µ–µ —É–ª—É—á—à–µ–Ω–∏–µ) | –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –¥–ª—è –∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ |

### –¢—Ä–∏–≥–≥–µ—Ä—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ (–ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é)
- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, 09:00)
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, 30, 14, 7, 3 –¥–Ω—è –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è)
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤—Å–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∏–º –ø–æ–ª—É—á–∞—Ç–µ–ª—è–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫

#### –†—É—á–Ω—ã–µ (–∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º)
- –ù–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ –±–æ—Ç–∞: `/notify <client_id> <deadline_id>`
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∫–ª–∏–µ–Ω—Ç—É
- –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è —Å—Ä–æ—á–Ω—ã—Ö –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –∏–ª–∏ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–µ–¥–ª–∞–π–Ω–∞

### –ü–æ—Ç–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

```mermaid
flowchart TD
    Start[–ó–∞–ø—É—Å–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞] --> CheckDays{–î–ª—è –∫–∞–∂–¥–æ–≥–æ<br/>–¥–Ω—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è}
    CheckDays --> QueryDB[–ó–∞–ø—Ä–æ—Å –∏—Å—Ç–µ–∫–∞—é—â–∏—Ö –¥–µ–¥–ª–∞–π–Ω–æ–≤]
    QueryDB --> FilterActive[–§–∏–ª—å—Ç—Ä –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–µ–¥–ª–∞–π–Ω–æ–≤]
    FilterActive --> ForEachDeadline{–î–ª—è –∫–∞–∂–¥–æ–≥–æ<br/>–¥–µ–¥–ª–∞–π–Ω–∞}
    
    ForEachDeadline --> GetClient[–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ –∫–ª–∏–µ–Ω—Ç–∞]
    GetClient --> CheckClient{–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è<br/>–∫–ª–∏–µ–Ω—Ç–∞<br/>–≤–∫–ª—é—á–µ–Ω—ã?}
    CheckClient -->|–î–∞| CheckTG{–ï—Å—Ç—å telegram_id?}
    CheckClient -->|–ù–µ—Ç| SkipClient[–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞]
    
    CheckTG -->|–î–∞| SendClient[–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É]
    CheckTG -->|–ù–µ—Ç| LogNoTG[–ó–∞–ø–∏—Å–∞—Ç—å: –ö–ª–∏–µ–Ω—Ç –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω]
    
    SendClient --> NotifyAdmins[–£–≤–µ–¥–æ–º–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤]
    LogNoTG --> NotifyAdmins
    SkipClient --> NotifyAdmins
    
    NotifyAdmins --> LogNotification[–ó–∞–ø–∏—Å–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ]
    LogNotification --> NextDeadline{–ï—â—ë<br/>–¥–µ–¥–ª–∞–π–Ω—ã?}
    NextDeadline -->|–î–∞| ForEachDeadline
    NextDeadline -->|–ù–µ—Ç| SendSummary[–û—Ç–ø—Ä–∞–≤–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Å–≤–æ–¥–∫—É –∞–¥–º–∏–Ω–∞–º]
    SendSummary --> End[–ö–æ–Ω–µ—Ü]
```

### –®–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π

#### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞

**–î–ª—è –æ–¥–Ω–æ–≥–æ –¥–µ–¥–ª–∞–π–Ω–∞**:
```
‚ö†Ô∏è –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ —Å—Ä–æ–∫–µ

–£—Å–ª—É–≥–∞: [Service Type]
–î–∞—Ç–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è: [DD.MM.YYYY]
–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π: [X]

–ö–æ–º–ø–∞–Ω–∏—è: [Company Name]
–ò–ù–ù: [INN]

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –¥–ª—è –ø—Ä–æ–¥–ª–µ–Ω–∏—è —É—Å–ª—É–≥–∏.
```

#### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**–î–ª—è –æ–¥–Ω–æ–≥–æ –¥–µ–¥–ª–∞–π–Ω–∞**:
```
üîî –î–µ–¥–ª–∞–π–Ω –∏—Å—Ç–µ–∫–∞–µ—Ç —á–µ—Ä–µ–∑ [X] –¥–Ω–µ–π

–ö–ª–∏–µ–Ω—Ç: [Company Name] (–ò–ù–ù: [INN])
–£—Å–ª—É–≥–∞: [Service Type]
–î–∞—Ç–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è: [DD.MM.YYYY]
–°—Ç–∞—Ç—É—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞: [–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ/–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ Telegram]

–ö–æ–º–∞–Ω–¥—ã:
/client_[client_id] - –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞
/notify_[client_id]_[deadline_id] - –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
```

#### –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã)

```
üìä –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞ –¥–µ–¥–ª–∞–π–Ω–æ–≤

–°–µ–≥–æ–¥–Ω—è: [DD.MM.YYYY]
–í—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏: [HH:MM]

üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
‚Ä¢ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –¥–µ–¥–ª–∞–π–Ω–æ–≤: [X]
‚Ä¢ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∫–ª–∏–µ–Ω—Ç–∞–º: [Y]
‚Ä¢ –ö–ª–∏–µ–Ω—Ç—ã –±–µ–∑ Telegram: [Z]
‚Ä¢ –û—à–∏–±–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏: [N]

‚ö†Ô∏è –¢—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è:
[List of upcoming deadlines grouped by urgency]

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞.
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞

### –£–¥–∞–ª—ë–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã CRUD –æ–ø–µ—Ä–∞—Ü–∏–π, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è –≤ –≤–µ–±-–∫–æ–Ω—Å–æ–ª—å:
- `/addclient`, `/editclient`, `/deleteclient`
- `/adddeadline`, `/editdeadline`, `/deletedeadline`
- –í—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–∏–∞–ª–æ–≥–æ–≤ –¥–ª—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–π

### –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∏ —É–ª—É—á—à–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

#### –î–ª—è –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

| –ö–æ–º–∞–Ω–¥–∞ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –û–ø–∏—Å–∞–Ω–∏–µ | –î–æ—Å—Ç—É–ø –ø–æ —Ä–æ–ª–∏ |
|---------|------------|----------|----------------|
| `/start` | –ù–µ—Ç | –ù–∞—á–∞—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–æ—Ç–æ–º –∏–ª–∏ –ø–æ–≤—Ç–æ—Ä–Ω—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é | –í—Å–µ |
| `/help` | –ù–µ—Ç | –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–∏ | –í—Å–µ |

#### –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤

| –ö–æ–º–∞–Ω–¥–∞ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|------------|----------|
| `/list` | –ù–µ—Ç | –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –ª–∏—á–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –¥–µ–¥–ª–∞–π–Ω—ã |
| `/today` | –ù–µ—Ç | –ü–æ–∫–∞–∑–∞—Ç—å –ª–∏—á–Ω—ã–µ –¥–µ–¥–ª–∞–π–Ω—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è |
| `/week` | –ù–µ—Ç | –ü–æ–∫–∞–∑–∞—Ç—å –ª–∏—á–Ω—ã–µ –¥–µ–¥–ª–∞–π–Ω—ã –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ |
| `/next` | `<–¥–Ω–∏>` | –ü–æ–∫–∞–∑–∞—Ç—å –ª–∏—á–Ω—ã–µ –¥–µ–¥–ª–∞–π–Ω—ã –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ N –¥–Ω–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 14) |

#### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –∏ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤

| –ö–æ–º–∞–Ω–¥–∞ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –û–ø–∏—Å–∞–Ω–∏–µ | –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω |
|---------|------------|----------|----------------|
| `/list` | –ù–µ—Ç | –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–µ–¥–ª–∞–π–Ω—ã (30 –¥–Ω–µ–π) | –ù–µ—Ç |
| `/today` | –ù–µ—Ç | –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–µ–¥–ª–∞–π–Ω—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è | –ù–µ—Ç |
| `/week` | –ù–µ—Ç | –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–µ–¥–ª–∞–π–Ω—ã –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ | –ù–µ—Ç |
| `/next` | `<–¥–Ω–∏>` | –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–µ–¥–ª–∞–π–Ω—ã –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ N –¥–Ω–µ–π | –ù–µ—Ç |
| `/filter` | `<client_id>` | –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –¥–µ–¥–ª–∞–π–Ω—ã –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∫–ª–∏–µ–Ω—Ç—É | –ù–µ—Ç |
| `/client` | `<client_id>` | –ü–æ–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –∫–ª–∏–µ–Ω—Ç–∞ —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ –∏ —Å–≤–æ–¥–∫–æ–π –¥–µ–¥–ª–∞–π–Ω–æ–≤ | –ù–µ—Ç |
| `/notify` | `<client_id> <deadline_id>` | –í—Ä—É—á–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É | –î–∞ |
| `/status` | –ù–µ—Ç | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã | –î–∞ |
| `/stats` | –ù–µ—Ç | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã (–∫–ª–∏–µ–Ω—Ç—ã, –¥–µ–¥–ª–∞–π–Ω—ã, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è) | –î–∞ |

### –î–µ—Ç–∞–ª–∏ –Ω–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥

#### `/filter <client_id>`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–µ–¥–ª–∞–π–Ω–æ–≤ –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∫–ª–∏–µ–Ω—Ç—É
- **–ü–æ–≤–µ–¥–µ–Ω–∏–µ**: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä —Å–µ—Å—Å–∏–∏, –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã `/list`, `/today`, `/week`, `/next` –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ç–æ–ª—å–∫–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- **–û—á–∏—Å—Ç–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä**: `/filter clear` –∏–ª–∏ `/filter 0`
- **–û—Ç–≤–µ—Ç**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–µ–¥–ª–∞–π–Ω—ã –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏

#### `/client <client_id>`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª–∏–µ–Ω—Ç–µ
- **–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞**:
  ```
  üë§ –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞
  
  –ö–æ–º–ø–∞–Ω–∏—è: [Company Name]
  –ò–ù–ù: [INN]
  –ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ: [Full Name]
  –¢–µ–ª–µ—Ñ–æ–Ω: [Phone]
  Email: [Email]
  
  üì± Telegram: [–ü–æ–¥–∫–ª—é—á–µ–Ω/–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω]
  üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: [–í–∫–ª—é—á–µ–Ω—ã/–û—Ç–∫–ª—é—á–µ–Ω—ã]
  
  üìÖ –ê–∫—Ç–∏–≤–Ω—ã–µ –¥–µ–¥–ª–∞–π–Ω—ã: [X]
  ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (< 7 –¥–Ω–µ–π): [Y]
  
  –ö–æ–º–∞–Ω–¥—ã:
  /filter_[client_id] - –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ–¥–ª–∞–π–Ω—ã
  /notify_all_[client_id] - –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
  ```

#### `/notify <client_id> <deadline_id>`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –í—Ä—É—á–Ω—É—é –∑–∞–ø—É—Å—Ç–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –¥–µ–¥–ª–∞–π–Ω–∞
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: 
  - –ö–ª–∏–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –¥–µ–¥–ª–∞–π–Ω—É
  - –ö–ª–∏–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å `telegram_id` (–ø–æ–¥–∫–ª—é—á—ë–Ω –∫ Telegram)
- **–ü–æ–≤–µ–¥–µ–Ω–∏–µ**: 
  - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É
  - –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ —Ç–∞–±–ª–∏—Ü—É `notification_logs`
  - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
- **–û—Ç–≤–µ—Ç**: –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ –∏–ª–∏ –æ—à–∏–±–∫–µ —Å –¥–µ—Ç–∞–ª—è–º–∏

## –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –£–¥–∞–ª–µ–Ω–∏–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–π

**–¶–µ–ª–µ–≤—ã–µ —Ñ–∞–π–ª—ã**:
- `bot/handlers/client_management.py` - —É–¥–∞–ª–∏—Ç—å –≤–µ—Å—å —Ñ–∞–π–ª
- `bot/handlers/deadline_management.py` - —É–¥–∞–ª–∏—Ç—å –≤–µ—Å—å —Ñ–∞–π–ª
- `bot/handlers/crud_conversations.py` - —É–¥–∞–ª–∏—Ç—å –≤–µ—Å—å —Ñ–∞–π–ª
- `bot/main.py` - —É–¥–∞–ª–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é —Ä–æ—É—Ç–µ—Ä–æ–≤

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –ò–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Å—Ç–∞—é—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º–∏)

**–í–∞–ª–∏–¥–∞—Ü–∏—è**: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è

### –≠—Ç–∞–ø 2: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤

**–¶–µ–ª–µ–≤—ã–µ —Ñ–∞–π–ª—ã**:
- `bot/handlers/common.py` - —É–ª—É—á—à–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `/start`
- `bot/middlewares/auth.py` - –æ–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–æ–ª–∏
- `bot/handlers/registration.py` - –Ω–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è –ø–æ—Ç–æ–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**–ü–æ–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** (—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ –º–æ–¥–µ–ª–∏ User):
- `registration_code`
- `code_expires_at`
- `telegram_id`
- `telegram_username`

**–ü—Ä–æ—Ü–µ—Å—Å**:
1. –ò–∑–º–µ–Ω–∏—Ç—å `/start` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ï—Å–ª–∏ –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω, –∑–∞–ø—Ä–æ—Å–∏—Ç—å –∫–æ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
3. –°–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ–¥–∞
4. –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –¥–∞–Ω–Ω—ã–º–∏ Telegram –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏
5. –û–±–Ω–æ–≤–∏—Ç—å AuthMiddleware –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä–æ–ª–∏ –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ `telegram_id`

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**:
- –î–æ–±–∞–≤–∏—Ç—å `REGISTRATION_CODE_LENGTH = 6`
- –î–æ–±–∞–≤–∏—Ç—å `REGISTRATION_CODE_EXPIRY_HOURS = 72`

### –≠—Ç–∞–ø 3: –£–ª—É—á—à–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**–¶–µ–ª–µ–≤—ã–µ —Ñ–∞–π–ª—ã**:
- `bot/handlers/admin.py` - –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã
- `bot/handlers/deadlines.py` - –∏–∑–º–µ–Ω–∏—Ç—å –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

**–ù–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏**:
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ `/filter` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º client_id
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ `/client` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ `/notify` –¥–ª—è —Ä—É—á–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ `/stats` –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º**:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Aiogram FSM (–∫–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç) –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ–π in-memory —Å–ª–æ–≤–∞—Ä—å –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ –Ω–∞ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –≠—Ç–∞–ø 4: –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–¶–µ–ª–µ–≤—ã–µ —Ñ–∞–π–ª—ã**:
- `bot/services/notifier.py` - —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–∏–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `bot/scheduler.py` - —É–ª—É—á—à–µ–Ω–∏–µ —Ä—É—Ç–∏–Ω—ã –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π**: 
   - –ó–∞–ø—Ä–æ—Å —Ç–∞–±–ª–∏—Ü—ã User —Å `role = 'client'` –∏ `telegram_id IS NOT NULL`
   - –í–∫–ª—é—á–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
   - –ë—É–¥—É—â–µ–µ: –≤–∫–ª—é—á–∏—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤

2. **–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π**:
   - –û—Ç–¥–µ–ª—å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
   - –í–∫–ª—é—á–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å client_id, deadline_id)

3. **–£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**:
   - –ó–∞–ø–∏—Å—ã–≤–∞—Ç—å —Ä–æ–ª—å –ø–æ–ª—É—á–∞—Ç–µ–ª—è –≤ `notification_logs`
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ä—É—á–Ω—ã–µ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**:
   - –ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –ø—Ä–∏ —Å–±–æ–µ –æ–¥–Ω–æ–≥–æ
   - –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –≤ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Å–≤–æ–¥–∫–µ

### –≠—Ç–∞–ø 5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ Middleware

**–¶–µ–ª–µ–≤—ã–µ —Ñ–∞–π–ª—ã**:
- `bot/middlewares/auth.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏**:
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é `TELEGRAM_ADMIN_IDS` ‚Üí role = 'admin'
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é `TELEGRAM_MANAGER_IDS` ‚Üí role = 'manager'
- –ó–∞–ø—Ä–æ—Å–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É User –ø–æ `telegram_id` ‚Üí –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω, role = 'client', client_id = user.id
- –ò–Ω–∞—á–µ ‚Üí role = 'unknown', –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø

**–ú–∞—Ç—Ä–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**:

| –¢–∏–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –ú–µ—Ç–æ–¥ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–Ω–∞—è —Ä–æ–ª—å | Client ID |
|-----------|------------------|-------------------|----------|
| –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä | –í `TELEGRAM_ADMIN_IDS` | `admin` | NULL |
| –ú–µ–Ω–µ–¥–∂–µ—Ä | –í `TELEGRAM_MANAGER_IDS` | `manager` | NULL |
| –ö–ª–∏–µ–Ω—Ç | –ù–∞–π–¥–µ–Ω –≤ `users` —Å —Å–æ–≤–ø–∞–¥–∞—é—â–∏–º `telegram_id` | `client` | `user.id` |
| –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π | –ù–∏ –æ–¥–Ω–æ –∏–∑ –≤—ã—à–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ | `unknown` | NULL |

## –°–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å—Ö–µ–º—ã

–¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å User —É–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è:
- `telegram_id` - –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞ Telegram
- `registration_code` - –¥–ª—è –∫–æ–¥–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `code_expires_at` - –¥–ª—è –∏—Å—Ç–µ—á–µ–Ω–∏—è –∫–æ–¥–∞
- `role` - –¥–ª—è –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏–∏ —Ä–æ–ª–µ–π (client, manager, admin)
- `notifications_enabled` - –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–ú–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è**.

### –®–∞–±–ª–æ–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤

#### –ù–∞–π—Ç–∏ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –¥–µ–¥–ª–∞–π–Ω–∞

```
–î–ª—è –¥–∞–Ω–Ω–æ–≥–æ –¥–µ–¥–ª–∞–π–Ω–∞:
1. –ü–æ–ª—É—á–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞ –¥–µ–¥–ª–∞–π–Ω–∞ (user_id –∏–∑ —Ç–∞–±–ª–∏—Ü—ã deadlines)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å user.notifications_enabled –∏ user.telegram_id
3. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
4. –í–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ telegram_ids –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
```

#### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

```
Query: SELECT * FROM users 
       WHERE registration_code = ? 
       AND code_expires_at > NOW()
       AND telegram_id IS NULL
```

#### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```
Query: SELECT id, role, company_name, notifications_enabled 
       FROM users 
       WHERE telegram_id = ?
       AND is_active = true
```

## Configuration Updates

### New Environment Variables

Add to `.env` and `backend/config.py`:

| Variable | Type | Default | Description |
|----------|------|---------|-------------|
| `TELEGRAM_MANAGER_IDS` | List[int] | `[]` | Telegram IDs of managers (comma-separated) |
| `REGISTRATION_CODE_LENGTH` | int | `6` | Length of registration codes |
| `REGISTRATION_CODE_EXPIRY_HOURS` | int | `72` | Code validity period |
| `NOTIFICATION_INCLUDE_ADMINS` | bool | `true` | Send notifications to administrators |
| `ADMIN_SUMMARY_ENABLED` | bool | `true` | Send daily summary to administrators |

### Existing Variables

Retain all existing notification configuration:
- `NOTIFICATION_DAYS` (e.g., "30,14,7,3")
- `NOTIFICATION_CHECK_TIME` (e.g., "09:00")
- `NOTIFICATION_TIMEZONE` (e.g., "Europe/Moscow")

## Security Considerations

### Registration Code Security

- Codes are single-use (cleared after successful registration)
- Time-limited validity (72 hours default)
- Stored as plain text (acceptable for temporary codes)
- Unique constraint prevents duplicates

### Authorization Verification

- Every command checks user role via middleware
- Role stored in event context, not in user-controllable data
- Database queries filtered by authenticated user's client_id for client role

### Data Privacy

- Clients can only access their own deadlines
- Administrators and managers see all data (legitimate business need)
- Telegram usernames logged for audit purposes

## Testing Strategy

### Unit Testing

**Authentication Flow**:
- Valid code registration
- Expired code rejection
- Invalid code rejection
- Duplicate registration prevention

**Role-Based Access**:
- Client cannot access other clients' deadlines
- Admin can access all deadlines
- Manager can access all deadlines (when implemented)

**Notification Delivery**:
- Single recipient success
- Multiple recipients with partial failure
- Logging accuracy

### Integration Testing

**End-to-End Flows**:
1. Client registration via web console + Telegram authorization
2. Automated notification delivery to client and admin
3. Manual notification trigger by admin
4. Filter application and client card display

### User Acceptance Testing

**Scenarios**:
- New client receives code and successfully authorizes
- Client views their deadlines in Telegram
- Administrator filters deadlines by client
- Administrator manually sends notification to client
- Daily summary contains accurate statistics

## Migration Path

### For Existing Bot Users

**Administrators**:
- No action required
- Configuration already contains their Telegram IDs
- Immediately gain access to new commands

**Clients** (if any were using bot for CRUD):
- Must complete registration flow via web console
- Administrator generates codes and distributes
- Clients authorize via `/start` command
- Previous Telegram interactions not preserved

### For New Deployments

1. Administrator configures `TELEGRAM_ADMIN_IDS` in `.env`
2. Starts bot service
3. Creates clients in web console
4. Generates registration codes for clients
5. Distributes codes to clients (email/manual)
6. Clients authorize via Telegram
7. System begins automated notifications

## Success Metrics

### Functional Metrics

- Registration code generation rate
- Client authorization success rate
- Notification delivery success rate
- Command usage frequency by role
- Response time for manual notifications

### User Experience Metrics

- Time to complete client authorization
- Client satisfaction with notification timeliness
- Administrator efficiency in managing client communications
- Reduction in missed deadlines due to improved notifications

## Future Enhancements

### Manager Role Expansion

- Assign specific clients to managers
- Managers receive notifications only for their clients
- Manager-specific dashboard in web console

### Advanced Filtering

- `/filter` by service type
- `/filter` by expiration date range
- `/filter` by notification status

### Interactive Notifications

- Inline buttons for "Remind me later" (reschedule notification)
- "Mark as renewed" button to update deadline status
- Direct link to web console for deadline management

### Client Self-Service

- `/renew` command to request deadline extension (sends request to admin)
- `/history` command to view past deadlines
- Notification preference customization via bot

### Analytics and Reporting

- Weekly digest for administrators
- Deadline trend analysis
- Client engagement metrics (command usage, notification open rates)

## Open Questions and Decisions Needed

1. **Manager Role**: Should managers be implemented in Phase 1 or deferred?
   - **Recommendation**: Defer to future enhancement, focus on admin/client first

2. **Registration Code Delivery**: Email vs. manual distribution?
   - **Recommendation**: Display in web console with copy button, manual distribution initially

3. **Notification Frequency**: Should clients be able to customize their notification days?
   - **Recommendation**: Use global defaults initially, add customization in future enhancement

4. **Command Aliases**: Should we support Russian and English command names?
   - **Recommendation**: Russian primary (current user base), English aliases for future expansion

5. **Error Notification**: Should clients be notified if admin sends manual notification?
   - **Recommendation**: Yes, with indication that it's a manual reminder from administrator

## Conclusion

This redesign transforms the Telegram bot from a dual-purpose management/notification tool into a focused notification and monitoring system with clear role separation. By moving all management operations to the web console and implementing proper client authorization, the system achieves better separation of concerns, improved security, and enhanced user experience for both administrators and clients.

The implementation leverages existing database schema and infrastructure, minimizing disruption while adding significant value through role-based access and automated notification delivery to all stakeholders.
