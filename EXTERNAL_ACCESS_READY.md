# ‚úÖ –ü—Ä–æ–µ–∫—Ç –ö–ö–¢ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø

## üåê –î–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–µ

### –í–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø (–¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞)
```
http://kkt-box.net:8080
```

**–£—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- Email: `admin@kkt.local`
- –ü–∞—Ä–æ–ª—å: `admin123`

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –î–æ–º–µ–Ω | kkt-box.net |
| IP –∞–¥—Ä–µ—Å | 185.185.71.248 |
| –ü–æ—Ä—Ç | 8080 |
| –ü—Ä–æ—Ç–æ–∫–æ–ª | HTTP (–≤ –±—É–¥—É—â–µ–º HTTPS) |

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–≤–µ—Ä–∫–∞ |
|-----------|--------|----------|
| VDS –°–µ—Ä–≤–µ—Ä | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | Ubuntu 24.04, –¥–æ—Å—Ç—É–ø–µ–Ω |
| Nginx | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –°–ª—É—à–∞–µ—Ç 0.0.0.0:8080 |
| kkt-web.service | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | Uvicorn –Ω–∞ –ø–æ—Ä—Ç—É 8000 |
| PostgreSQL | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ë–∞–∑–∞ kkt_production |
| Firewall | ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω | –ü–æ—Ä—Ç 8080 –æ—Ç–∫—Ä—ã—Ç |

### 2. API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

| –≠–Ω–¥–ø–æ–∏–Ω—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|--------|----------|
| /health | ‚úÖ OK | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ |
| /api/auth/login | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –û—à–∏–±–∫–∞ 422 |
| /api/users | üîí –¢—Ä–µ–±—É–µ—Ç —Ç–æ–∫–µ–Ω | –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| /api/users/{id}/full-details | üîí –¢—Ä–µ–±—É–µ—Ç —Ç–æ–∫–µ–Ω | –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞ |
| /api/deadline-types | üîí –¢—Ä–µ–±—É–µ—Ç —Ç–æ–∫–µ–Ω | –¢–∏–ø—ã –¥–µ–¥–ª–∞–π–Ω–æ–≤ |
| /api/ofd-providers | üîí –¢—Ä–µ–±—É–µ—Ç —Ç–æ–∫–µ–Ω | –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã –û–§–î |
| /api/dashboard/stats | üîí –¢—Ä–µ–±—É–µ—Ç —Ç–æ–∫–µ–Ω | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |
| /api/deadlines | üîí –¢—Ä–µ–±—É–µ—Ç —Ç–æ–∫–µ–Ω | –°–ø–∏—Å–æ–∫ –¥–µ–¥–ª–∞–π–Ω–æ–≤ |

### 3. –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –°—Ç–∞—Ç—É—Å |
|------|--------|
| /static/login.html | ‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω |
| /static/dashboard.html | ‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω |
| /static/client-details.html | ‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω |
| /static/css/styles.css | ‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω |
| /static/js/*.js | ‚úÖ –î–æ—Å—Ç—É–ø–Ω—ã |

### 4. Nginx –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```nginx
upstream kkt_backend {
    server 127.0.0.1:8000;
    keepalive 32;
}

server {
    listen 8080;
    server_name kkt-box.net 185.185.71.248;
    
    # Static files
    location /static/ {
        alias /home/kktapp/kkt-system/web/app/static/;
        expires 30d;
        add_header Cache-Control "public, immutable";
    }
    
    # API and application
    location / {
        proxy_pass http://kkt_backend;
        ...
    }
}
```

## üîß –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –û—à–∏–±–∫–∞ 422 –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ

**–°–∏–º–ø—Ç–æ–º:**
```
POST /api/auth/login HTTP/1.1" 422 Unprocessable Entity
```

**–ü—Ä–∏—á–∏–Ω–∞:** –í–æ–∑–º–æ–∂–Ω–æ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞ –∏–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

**–†–µ—à–µ–Ω–∏–µ:** –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ `web/app/api/auth.py`.

### 2. –û—à–∏–±–∫–∞ —Å cash_registers

–í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–∞ –æ—à–∏–±–∫–∞ PostgreSQL:
```
column cash_registers.is_active does not exist
Hint: Perhaps you meant to reference the column "cash_registers.isactive"
```

**–†–µ—à–µ–Ω–∏–µ:** –¢—Ä–µ–±—É–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–∫–∏ `isactive` ‚Üí `is_active` –≤ —Ç–∞–±–ª–∏—Ü–µ `cash_registers`.

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä—è–º–æ–π –≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ http://kkt-box.net:8080
3. –í–æ–π–¥–∏—Ç–µ —Å —É—á—ë—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
4. –†–∞–±–æ—Ç–∞–π—Ç–µ —Å —Å–∏—Å—Ç–µ–º–æ–π

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –î–æ—Å—Ç—É–ø –∏–∑ –ª—é–±–æ–≥–æ –º–µ—Å—Ç–∞
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è SSH —Ç—É–Ω–Ω–µ–ª—å
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ª—é–±–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ SSH —Ç—É–Ω–Ω–µ–ª—å (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç—É–Ω–Ω–µ–ª—å: `.\start_ssh_tunnel_background.ps1`
2. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8080
3. –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –£–¥–æ–±–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ health endpoint
curl http://kkt-box.net:8080/health -UseBasicParsing

# –û–∂–∏–¥–∞–µ—Ç—Å—è:
# {"status":"healthy","service":"KKT Management System","version":"1.0.0"}
```

### –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```powershell
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç (—Ç—Ä–µ–±—É–µ—Ç—Å—è SSH —Ç—É–Ω–Ω–µ–ª—å)
.\test_all.ps1
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

| –ê—Å–ø–µ–∫—Ç | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|--------|--------|-------------|
| HTTPS | ‚ùå –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω | HTTP —Ç–æ–ª—å–∫–æ |
| SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç | ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | –ù—É–∂–µ–Ω Let's Encrypt |
| Firewall | ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω | –¢–æ–ª—å–∫–æ 22, 8080 –æ—Ç–∫—Ä—ã—Ç—ã |
| –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è | ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã | 8 —á–∞—Å–æ–≤ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è |
| Password hashing | ‚úÖ Bcrypt | –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS** - –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö
2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** - Let's Encrypt (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
3. **–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –Ω–∞ –ø–æ—Ä—Ç 443** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π HTTPS –ø–æ—Ä—Ç
4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞** - —á–µ—Ä–µ–∑ certbot

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É 422 –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ö–µ–º—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏
   - –£–±–µ–¥–∏—Ç—å—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–º–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä

2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É cash_registers.is_active**
   - –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–∫–∏
   - –ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω –ë–î
   - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å kkt-web.service

3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä**
   - –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–ª–∏–µ–Ω—Ç–æ–≤
   - –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞
   - –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Å
   - –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ–¥–ª–∞–π–Ω–æ–≤

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ

4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS**
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å certbot
   - –ü–æ–ª—É—á–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
   - –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å HTTP ‚Üí HTTPS

5. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
   - Alerts –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–∞
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤

6. **Backup —Å—Ç—Ä–∞—Ç–µ–≥–∏—è**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –ë–î
   - –ë—ç–∫–∞–ø —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - –•—Ä–∞–Ω–µ–Ω–∏–µ –≤ –æ–±–ª–∞–∫–µ

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–ª—É–∂–±

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ VDS
ssh root@185.185.71.248

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
systemctl status nginx
systemctl status kkt-web
systemctl status kkt-bot

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
journalctl -u kkt-web -n 50 --no-pager
journalctl -u nginx -n 50 --no-pager
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
sudo systemctl restart kkt-web

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ nginx
sudo systemctl restart nginx

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ nginx
sudo nginx -t
```

---

**–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∏ –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç  
**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2025-12-14  
**–í–Ω–µ—à–Ω–∏–π URL:** http://kkt-box.net:8080  
**–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π URL:** http://localhost:8000 (–Ω–∞ VDS)
